欢迎使用 ShapePainter！这是一款为了深入学习、对比和展示计算机图形学底层原理而精心打造的实验平台。它内置了一套完整的、从零开始编写的自定义光栅化渲染引擎，并可以与系统原生的专业矢量引擎进行实时对比。

本手册将带您快速了解并精通 ShapePainter 的所有核心功能。


1. 认识主界面
--------------------------------
ShapePainter 的主界面清晰地划分为几个关键区域：

    - 菜单栏 (Menu Bar): 位于最顶部，提供文件保存/加载、编辑操作、视图质量控制和导出等所有高级功能。
    - 顶部工具栏 (Top Toolbars): 包含最常用的功能，如颜色设置、线宽、填充方式、对齐，以及核心的【渲染引擎切换】。
    - 左侧绘图工具栏 (Drawing Toolbar): 包含了所有用于创建新图形的工具。
    - 主画布 (Canvas): 中间的广阔白色区域，是您的创作空间，边缘配有【标尺】。
    - 图层面板 (Layer Panel): 位于右侧，用于管理和组织图形所在的图层，支持不透明度、锁定和【混合模式】。


2. 核心功能：双渲染引擎切换与对比
-----------------------------------------
这是 ShapePainter 的灵魂功能，请务必掌握！

在顶部工具栏，您会找到一个名为【直线算法】的下拉菜单。它控制着整个画布的渲染方式：

    - "Bresenham" / "DDA": 选择这些选项时，画布将启用我们【完全自定义的光栅化渲染引擎】。所有图形（包括复杂的贝塞尔曲线）都由我们自己实现的底层算法逐像素绘制而成。这是验证和学习图形学的核心模式。

    - "PyQt原生": 选择此项时，画布将切换到由 Qt6 提供的【专业级矢量渲染引擎】。所有图形都由系统库绘制，速度快，功能全面。

通过在这两种模式间切换，您可以直观地对比底层算法与专业引擎在效果和性能上的差异。


3. 基础绘图操作
--------------------------------
*   绘制基础形状 (矩形、圆形、椭圆等):
    1. 从左侧工具栏单击您想绘制的图形按钮。
    2. 在画布上按住鼠标左键并拖动。
    3. 松开鼠标即可创建完成。

*   绘制直线或箭头:
    1. 选择【直线】或【箭头】工具。
    2. 在画布上点击确定起点，拖动到终点，然后松开鼠标。
    *   专业提示: 使用【直线工具】时，按住 [Shift] 键可以临时将其变为【箭头工具】。

*   绘制折线或多边形:
    1. 选择相应工具。
    2. 在画布上依次单击鼠标左键来确定每个顶点。
    3. 完成时，【双击鼠标左键】或【单击鼠标右键】即可结束绘制。

*   手绘与橡皮擦:
    1. 选择【手绘】或【橡皮擦】工具。
    2. 在画布上按住鼠标左键并自由拖动即可。橡皮擦的大小与当前【线宽】设置相关。


4. 精通贝塞尔曲线 (钢笔) 工具
-----------------------------------------
这是我们自定义引擎攻克的最后一个、也是最强大的工具，让您可以绘制任何复杂的平滑曲线。

    - 创建尖角: 在画布上 [单击]，创建一个直接的转折点。
    - 创建平滑曲线: 在画布上 [单击并拖动]，可以拉出控制手柄，形成平滑的曲线。
    - 闭合路径: 将鼠标移动到路径的第一个点上并 [单击]，路径会自动闭合。
    - 创建新分支: 在绘制过程中，[单击] 路径上任何一个已存在的点，都会从该点开始一条新的路径分支。
    - 结束绘制: 【双击】、【右键】或按 [ESC] 键均可完成整个路径的创建。
    - 绘制时撤销: 如果画错了最后一个点，只需按 [Ctrl+Z] 即可撤销它。


5. 编辑与变换
--------------------------------
*   选择图形:
    1. 使用【选择】工具 (鼠标指针图标)。
    2. 按住 [Shift] 键可以进行多选。在画布空白处拖出一个矩形框，可以进行框选。

*   基本变换 (选中图形后):
    - 移动: 直接拖动图形。
    - 缩放: 拖动选择框的四个角点。
    - 旋转: 拖动选择框顶部中心伸出的控制手柄。
    - 翻转: 单击鼠标 [右键]，在菜单中选择翻转选项。

*   组合与解组:
    - 组合 (Ctrl+G): 将多个图形变为一个整体。
    - 解组 (Ctrl+Shift+G): 将组合图形恢复为独立的图形。

*   高级节点编辑:
    1. 使用【选择】工具 [双击] 一个路径或多边形，即可进入节点编辑模式。
    2. 拖动锚点 (方形点): 改变图形的基本结构。
    3. 拖动手柄 (圆形点): 调整贝塞尔曲线的弧度。
    4. 高级操作 (贝塞尔曲线):
        - 按住 [Alt] 键拖动手柄，进行不对称调整。
        - 按住 [Alt] 键 [单击] 锚点，在尖角与平滑节点之间切换。
        - 按住 [Ctrl + Alt] 键 [单击] 锚点，【删除】该锚点。
        - [单击] 开放路径的端点，可以从该点继续向后绘制。
    5. 再次 [双击] 图形或按 [ESC] 键，即可退出节点编辑模式。


6. 图层与显示质量
--------------------------------
*   图层管理:
    右侧的图层面板功能强大。您可以添加、删除、排序、重命名、显示/隐藏和锁定图层。每个图层都有独立的【不透明度】滑块和【混合模式】下拉菜单（支持正片叠底、滤色等专业模式）。

*   显示质量控制 (在“视图”菜单中):
    - 显示网格: 为画布添加背景网格。
    - 吸附: 开启后，操作会自动吸附到网格或参考线上。
    - 参考线: 从画布边缘的【标尺】上用鼠标左键拖出即可创建。
    - **启用抗锯齿 (SSAA)**: 核心功能！勾选此项，我们自定义的光栅化引擎会启用2x超采样抗锯齿，所有图形边缘将变得平滑。此开关仅在我们自己的 "Bresenham" / "DDA" 模式下生效。


7. 填充与对齐
--------------------------------
*   填充图形:
    使用顶部工具栏的【填充色】、【填充方式】下拉菜单和【颜料桶】工具来为图形上色。
    **【特别注意】**: 我们的自定义渲染引擎目前只实现了“无”和“纯色”填充。当您选择 "Bresenham" 或 "DDA" 算法时，填充方式下拉菜单会自动精简，并明确提示其他样式需要原生模式。这是为了清晰地展示不同引擎的能力边界。

*   对齐工具:
    当您选中两个或更多图形时，顶部的【对齐工具栏】会被激活，您可以用它来快速地将对象进行左对齐、居中、顶对齐等操作。


8. 文件与设置
--------------------------------
*   保存与加载:
    通过“文件”菜单，您可以将整个项目（包含所有图层和图形）保存为 `.json` 文件，以便将来继续编辑。

*   导出作品:
    您可以将画布内容导出为 `.png` 位图文件，或 **`.svg` 可缩放矢量文件**。

*   偏好设置:
    在“编辑”菜单中打开“偏好设置”，可以自定义默认的画笔颜色、宽度、字体和画布背景色。您的设置会被自动保存。
