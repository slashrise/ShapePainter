<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
    body { font-family: "Microsoft YaHei", sans-serif; line-height: 1.6; color: #333; }
    h1 { color: #2c3e50; text-align: center; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
    h2 { color: #2980b9; background-color: #ecf0f1; padding: 5px 10px; border-left: 5px solid #2980b9; margin-top: 30px; }
    h3 { color: #e67e22; margin-top: 20px; margin-bottom: 5px; font-size: 1.1em; }
    p { margin-bottom: 10px; }
    ul { margin-top: 5px; }
    li { margin-bottom: 5px; }
    strong { color: #c0392b; font-weight: bold; }
    .key { background-color: #f7f7f7; border: 1px solid #ccc; border-radius: 3px; padding: 0 5px; font-family: monospace; color: #555; font-size: 0.9em; box-shadow: 0 1px 0 rgba(0,0,0,0.2); }
    .note { background-color: #fff8e1; border: 1px solid #f1c40f; border-left-width: 5px; padding: 10px; margin: 15px 0; color: #7f8c8d; }
    .highlight { color: #27ae60; font-weight: bold; }
</style>
</head>
<body>

<h1>📖 ShapePainter v4.3 全功能用户手册</h1>

<p>欢迎使用 <b>ShapePainter v4.3</b>！这是一款为了深入学习、对比和展示计算机图形学底层原理而精心打造的实验平台。它不仅具备专业绘图软件的交互体验，更内置了一套从零编写的高性能光栅化渲染引擎。</p>

<h2>1. 认识主界面</h2>
<ul>
    <li><b>菜单栏 (Menu Bar):</b> 位于顶部，提供文件存取、编辑撤销、视图设置、导出等全局功能。</li>
    <li><b>顶部工具栏 (Top Toolbar):</b> 包含画笔颜色、线宽、填充样式、<span class="highlight">直线算法切换</span>以及对齐工具。</li>
    <li><b>左侧绘图栏 (Drawing Toolbar):</b> 包含了从点、线到贝塞尔曲面等所有绘图工具。</li>
    <li><b>主画布 (Canvas):</b> 中央的白色创作区域，四周配有专业级标尺。</li>
    <li><b>图层面板 (Layer Panel):</b> 位于右侧，用于管理图层顺序、透明度及混合模式。</li>
</ul>

<h2>2. 核心机制：双渲染引擎</h2>
<div class="note">
    这是本软件的灵魂功能！通过顶部工具栏的【直线算法】下拉菜单，您可以在两种渲染模式间实时切换。
</div>
<ul>
    <li><strong>"Bresenham" / "DDA" (自研引擎):</strong> 启用我们<b>完全自定义的光栅化渲染引擎</b>。
        <ul>
            <li>所有图形（包括圆角矩形、B样条、曲面）均由底层算法计算出的扫描线段 (Spans) 绘制。</li>
            <li>支持 <b>Gouraud</b> 颜色插值和 <b>SSAA</b> 抗锯齿。</li>
            <li>这是验证图形学算法原理的核心模式。</li>
        </ul>
    </li>
    <li><strong>"PyQt原生" (参考引擎):</strong> 切换到 Qt6 提供的<b>专业级矢量引擎</b>。主要用于对比渲染效果和性能差异。</li>
</ul>

<h2>3. 基础绘图工具</h2>
<p>在左侧工具栏选择工具后，在画布上拖动即可绘制。</p>
<ul>
    <li><b>基础形状:</b> 矩形、正方形、圆形、椭圆、圆角矩形。</li>
    <li><b>点与线:</b>
        <ul>
            <li><b>点工具:</b> 单击画布画点。</li>
            <li><b>直线工具:</b> 拖动绘制直线。按住 <span class="key">Shift</span> 键可画水平/垂直线。</li>
            <li><b>箭头工具:</b> 绘制带箭头的直线。</li>
        </ul>
    </li>
    <li><b>多边形与折线:</b> 
        <ul>
            <li>左键依次点击确定顶点。</li>
            <li><span class="key">双击</span> 或 <span class="key">右键</span> 结束绘制。</li>
        </ul>
    </li>
    <li><b>手绘与橡皮:</b> 按住左键自由拖动。橡皮擦大小随当前线宽变化。</li>
</ul>

<h2>4. 高级参数曲线与曲面 (v4.3 重点)</h2>

<h3>✒️ 贝塞尔曲线 (Pen Tool)</h3>
<ul>
    <li><b>绘制:</b> <span class="key">单击</span> 创建尖角节点，<span class="key">拖动</span> 创建平滑手柄。</li>
    <li><b>分支:</b> 在绘制中点击路径上已有的点，可创建新的分支。</li>
    <li><b>闭合:</b> 点击起始点可闭合路径。</li>
</ul>

<h3>〰️ B样条曲线 (B-Spline)</h3>
<ul>
    <li><b>绘制:</b> 依次点击放置控制点，右键结束。</li>
    <li><b>特性:</b> 曲线平滑穿过首尾点。支持<b>自适应阶数</b>，即使只有3个点也能画出完美的抛物线，绝不崩坏。</li>
</ul>

<h3>🌐 贝塞尔曲面 (Bezier Surface)</h3>
<ul>
    <li><b>创建:</b> 在画布上拖拽出一个矩形区域，系统自动生成 4x4 控制网格。</li>
    <li><b>双重视图模式:</b>
        <ul>
            <li><b>网格显示 (Wireframe):</b> 显示黑色的经纬线，展示几何拓扑。</li>
            <li><b>曲面填充 (Surface Fill):</b> 显示红绿 UV 渐变色，演示 Gouraud 插值算法。</li>
            <li><i>提示：在曲面上 <span class="key">右键</span>，可独立开启/关闭这两种模式。</i></li>
        </ul>
    </li>
</ul>

<h2>5. 编辑与变换系统</h2>

<h3>选择与通用变换</h3>
<ul>
    <li><b>选择:</b> 使用选择工具（箭头图标）。按住 <span class="key">Shift</span> 可多选，或直接框选。</li>
    <li><b>移动:</b> 拖动图形主体。</li>
    <li><b>缩放 (OBB):</b> 拖动四周的控制点。支持<b>有向包围盒</b>算法，旋转后的图形依然沿自身轴向缩放，杜绝漂移。</li>
    <li><b>旋转:</b> 拖动选择框顶部伸出的“小杆子”。光标会随角度实时旋转。</li>
    <li><b>翻转:</b> 右键菜单支持水平/垂直翻转。</li>
</ul>

<h3>高级节点编辑</h3>
<p>使用选择工具 <span class="key">双击</span> 任意图形，进入节点编辑模式：</p>
<ul>
    <li><b>多边形/折线:</b> 拖动顶点改变形状。</li>
    <li><b>贝塞尔曲线:</b> 可以拖动锚点（方块）和手柄（圆点）。按住 <span class="key">Alt</span> 键拖动手柄可破坏对称性（折角）。</li>
    <li><b>贝塞尔曲面:</b> 显示灰色的<b>控制笼子 (Control Cage)</b>。拖动白色的控制点，曲面会实时发生扭曲变形。</li>
</ul>

<h2>6. 辅助功能与视图</h2>
<ul>
    <li><b>专业标尺:</b> 画布边缘的标尺支持文字竖排，解决了刻度重叠问题。</li>
    <li><b>参考线:</b> 鼠标按住标尺向画布内拖拽，即可拉出参考线。</li>
    <li><b>精密网格:</b> 在“视图”菜单开启。采用 Cosmetic Pen 技术，在高分屏缩放所有倍率下都能与标尺完美对齐。</li>
    <li><b>抗锯齿 (SSAA):</b> 视图菜单开启。自定义引擎将启用 2x 超采样，让像素边缘无比平滑。</li>
</ul>

<h2>7. 图层管理</h2>
<p>右侧图层面板提供了类似 Photoshop 的管理能力：</p>
<ul>
    <li><b>基本操作:</b> 添加、删除、重命名（双击）、上下移动图层。</li>
    <li><b>状态控制:</b> 切换可见性（眼睛图标）、锁定图层（锁图标）。</li>
    <li><b>混合模式:</b> 支持正片叠底、滤色、叠加等高级色彩混合算法。</li>
</ul>

<h2>8. 文件操作</h2>
<ul>
    <li><b>保存/加载:</b> 保存为 <code>.json</code> 项目文件，保留所有图层和矢量数据。</li>
    <li><b>导出:</b> 
        <ul>
            <li><b>PNG:</b> 导出为高清位图。</li>
            <li><b>SVG:</b> 导出为可缩放矢量图形，可放入浏览器或 AI 中编辑。</li>
        </ul>
    </li>
</ul>

</body>
</html>